<div class="alert alert-danger" ng-if="tulos.virhe">
  {{'raportit.liian_vahan_vastaajia' | i18n}}
</div>

<div class="raportti-kyselykerta-tiedot">
  <div>
    {{'yleiset.kyselykerta' | i18n }}: <span>{{tulos.kyselykerta.nimi}}</span>
  </div>
  <div>
    {{'yleiset.kysely' | i18n }}: <span>{{tulos.kyselykerta.kyselyid}}</span>
  </div>
  <div>
    {{'yleiset.voimassa' | i18n }}: <span>{{tulos.kyselykerta.voimassa_alkupvm | voimassaoloAika: tulos.kyselykerta.voimassa_loppupvm}}</span>
  </div>
  <hr>
  <div>
    {{'raportti.raportin_luontipaiva' | i18n }}: <span>{{tulos.luontipvm | date: 'dd.MM.yyyy'}}</span>
  </div>
</div>

<div ng-repeat="kysymys in tulos.raportti">
  <p>
    <h3>{{$index + 1}}. {{kysymys | lokalisoiKentta:'kysymys'}}</h3>

    <jakauma-kaavio
      ng-if="kysymys.vastaustyyppi === 'kylla_ei_valinta' || kysymys.vastaustyyppi === 'monivalinta'"
      jakauma="kysymys.jakauma" vastaustyyppi="kysymys.vastaustyyppi">
    </jakauma-kaavio>

    <vaittama-kaavio
      ng-if="kysymys.vastaustyyppi === 'asteikko'"
      jakauma="kysymys.jakauma">
    </vaittama-kaavio>

    <table class="report-table" ng-if="kysymys.vastaustyyppi === 'asteikko' || kysymys.vastaustyyppi === 'kylla_ei_valinta' || kysymys.vastaustyyppi === 'monivalinta'">
      <thead>
        <tr>
          <th class="report-table-question">{{kysymys | lokalisoiKentta:'kysymys'}}</th>
          <th class="report-table-percentage-field">Vast%</th>
          <th class="report-table-amount-header">n={{lukumaaratYhteensa(kysymys.jakauma)}}</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="alkio in kysymys.jakauma">
          <td class="e2e-vaihtoehto" ng-if="kysymys.vastaustyyppi !== 'monivalinta'">{{'kysymys.' + kysymys.vastaustyyppi + '.' + alkio['vaihtoehto-avain'] | i18n}}</td>
          <td class="e2e-vaihtoehto" ng-if="kysymys.vastaustyyppi === 'monivalinta'">{{alkio | lokalisoiKentta:'vaihtoehto' }}</td>
          <td class="report-table-percentage-field e2e-osuus">{{alkio.osuus}}%</td>
          <td class="report-table-amount-field e2e-vastausten-lukumaara">{{alkio.lukumaara}}</td>
        </tr>
      </tbody>
    </table>

    <div class="jatkokysymykset" ng-if="kysymys.jatkovastaukset">
      <h3>{{$index + 1}}. {{i18n.raportit.jatkokysymykset}}</h3>
      <div class="kylla-jatkokysymys" ng-if="kysymys.jatkovastaukset.kylla">
        <h4>{{kysymys.jatkovastaukset.kylla | lokalisoiKentta:'kysymys'}}</h4>
        <vaittama-kaavio jakauma="kysymys.jatkovastaukset.kylla.jakauma">
        </vaittama-kaavio>
      </div>
      <div class="ei-jatkokysymys" ng-if="kysymys.jatkovastaukset.ei">
        <h4>{{kysymys.jatkovastaukset.ei | lokalisoiKentta:'kysymys'}}</h4>
        <table class="report-table">
          <thead>
            <tr><th>{{'raportti.vastaukset' |i18n}}:</th></tr>
          </thead>
          <tbody>
            <tr ng-repeat="vastaus in kysymys.jatkovastaukset.ei.vastaukset">
              <td>{{vastaus.teksti}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <table class="report-table" ng-if="kysymys.vastaustyyppi === 'vapaateksti'">
      <thead>
        <tr><th>{{'raportti.vastaukset' |i18n}}:</th></tr>
      </thead>
      <tbody>
        <tr ng-repeat="vastaus in kysymys.vastaukset">
          <td>{{vastaus.teksti}}</td>
        </tr>
      </tbody>
    </table>
  </p>
</div>
